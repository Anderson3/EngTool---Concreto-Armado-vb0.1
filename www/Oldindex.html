<DOCTYPE html>

<html lang="pt-br">
	
	<head>

		<meta charser="utf-8"/>
		<title>Um único teste</title>

		<style type="text/css">
			*{margin: 0,0}

		</style>

		<script type="text/javascript">

			//função-teste (utilizada para quando haver problemas de verificação e correção de código)
			function mensagem(){
				alert("Oiiiiiiiiiiiiiiiii")
			}

			//função calcula os coefcientes kmd, kx, determina o domínio do ELU do concreto  com as dimensões estabelecidas, corrige quando necessário (Domínio 2-a, segundo Teattini) e repassa os valores para a função que calculará a área de aço.
			function calcular(){
				//variáveis usadas mais a frente para correção (Domínio 2-a), se necessário.
				var deformConcreto
				var tensaoConcreto
				//variável para o dmínio do concreto.
				var dominio
				//variáveis globais.
				var md = document.getElementById("momento-fletor").value * 1.4
				var fck = document.getElementById("fck").value
				var b = document.getElementById("bw").value / 100
				var h = document.getElementById("h").value
				var d = document.getElementById("d").value / 100
				
				//cálculo dos coeficientes K, adimensionais.
				var kmd = ((md * 1000)/((b * d*d * 0.85 * fck * 1000000)/1.4))

				var kx = (1 - Math.sqrt(1 - 2*kmd))/ (0.8) 
				
				//variável para condizer qual a próxima situação de cálculo a ser tomada, condicionei| 0-nãopode ser calculado| 1-pode ser calculado, mas precisará passar pela correção| 2-pode ser calculado, sem necessidade de correção.| Ela é verificada no final dessa função para permitir ou não a continuação do código.
				var condicao = 2 

				//domínio 1.
				if (kx < 0) {
					condicao = 0
					dominio = 'Domínio 1'
				}
				//domínio 2 generalizado.
				if (kx > 0 && kx < 0.259) {
					//deformação do concreto
					deformConcreto = (kx/(1-kx)) * 10

					//domínio 2-b, sem necessidade de correção.
					if (deformConcreto > 2) {
						condicao = 2
						dominio = 'Domínio 2 - Sem necessidade de correção'
					}
					//domínio 2-b, sem necessidade de correção.
					else{
						condicao = 1
						tensaoConcreto = ((0.85 * fck * 1000000 / 1.4) * (1- Math.pow((1-(deformConcreto/2)),2)))
						kmd = ((md * 1000)/(b * d * d * tensaoConcreto))
						kx = (1 - Math.sqrt(1 - 2*kmd))/ (0.8)
						condicao = 2
						dominio = 'Domínio 2 - Com necessidade de correção'
					}
				
				}
				//domínio 3, com ductibilidade (segundo a norma Kx < 0,45).
				if (kx > 0.259 && kx < 0.45) {
					condicao = 2
					dominio = 'Domínio 3 - Com Ductibilidade'
				}
				//domínio 3, sem ductibilidade (segundo a norma Kx > 0,45).
				if (kx > 0.45 && kx < 0.63) {
					condicao = 0
					dominio = 'Domínio 3 - Sem Ductibilidade'
				}
				
				//seção onde as condições são analisadas, conforme referido na variável condicao, de acordo com as condições de cálculo disponibilizadas no ELU do Concreto Armado referidas na norma NBR 6118/14. Aqui as condições são testadas e os cálculos redirecionados.
				switch (condicao){
					case 0:
						alert("Não é possível calcular uma armadura com esses valores em acordo com a ABNT NBR-6118/2014")
						break
					case 1:
						alert("A situação e condições geradas pelas informações da viga indicam Domínio 2 com concreto em fase plástica, será realizado uma correção nas tensões de compressão para aumentar a área de compressão e tornar uma situação mais favorável")
						break
					case 2:
						//prossegue com o cálculo das armaduras 
						calculoArea(md,b,h,d,kmd,kx,dominio)
						break
				}
			}
			
			//fução particular para o cálculo da armadura. Nessa função é cálculado primeiramente o Kz para depois adentrar na Área de Aço transversal. Preferiu-se deixar uma função específica para o coeficiente do braço de alavanca por este se utilizado somente para encontrar As, e facilitando o entendimento para a sequencia se a viga cairá ou não no domínio 2-a e igualmente se será aplicado a correção na tensão de compressão do concreto.
			function calculoArea(md,b,h,d,kmd,kx,dominio){
				//cálculo do Kz
				var kz = 1 - 0.4 * kx
				//cálculo da Área de Aço
				var as
				as = ((md * 1000)/(kz * d * (500) / 1.15))
				//cálculo da Área de Aço Sobre-Apoios
				var asp
				asp = (as/3)
				//verificação e cálculo da armadura de pele, caso seja necessário.
				var ap
				ap = 0
				if (h >= 60) {
					var areaSecao
					areaSecao = (b * h)
					ap = ((0.1 / 100) * areaSecao)
				}

				//envia os valores necessários para a função de modificação da página.
				retornaValores(md,kmd,kx,kz,as,asp,ap,dominio)
			}
			
			//função responsável por capturar os valores necessários que o usuário precisa, e 'escreve-los' na página de forma sequenciada.
			function retornaValores(md,kmd,kx,kz,as,asp,ap,dominio){
				document.getElementById("momento-projeto").innerHTML = md
				document.getElementById("dominio").innerHTML = dominio
				document.getElementById("kmd").innerHTML = kmd
				document.getElementById("kx").innerHTML = kx
				document.getElementById("kz").innerHTML = kz
				document.getElementById("areaAco").innerHTML = as
				document.getElementById("areaAcoSP").innerHTML = asp
				document.getElementById("areaAcoP").innerHTML = ap
			}

		</script>

	</head>

	<body>
		<hr>
		<h3>Cálculadora de Armações de Concreto Armado</h3>
		<br/>
		<br/>
		<hr>
			<p>Entre com o Valor do Momento Fletor Máximo (KN.m): <input id="momento-fletor" type="number"></input></p>
			<p>Entre com o Valor da Resistência à Compressão - Fck (Mpa): <input id="fck" type="number"></input></p>
			<p>Entre com o Valor da base - bw (cm): <input id="bw" type="number"></input></p>
			<p>Entre com o Valor da altura - h (cm): <input id="h" type="number"></input></p>
			<p>Entre com o Valor da altura útil - d (cm): <input id="d" type="number"></input></p>
		<hr>
			<input type="submit" value="CALCULAR" onclick="calcular()"></input>
		<hr>
			<p>Momento fletor de Projeto (Md): <span id="momento-projeto">0</span></p>
			<p>Domínio da viga no Estado de Limite Último-ELU: <span id="dominio"></span></p>
			<p>Kmd - coeficiente do momento: <span id="kmd">0</span></p>
			<p>Kx - coeficiente da linha neutra: <span id="kx">0</span></p>
			<p>Kz - coeficiente do braço de alavanca: <span id="kz">0</span></p>
		<hr>
			<p>Área de Aço para Seção Transversal - As (mm<sup>2</sup>): <span id="areaAco">0</span></p>
		<hr>
			<p>Área de Aço para Armadura Sobre-Apoios - Asp (mm<sup>2</sup>): <span id="areaAcoSP">0</span></p>
		<hr>
			<p>Área de Aço para Armadura de Pele - Ap (mm<sup>2</sup>/ face lateral): <span id="areaAcoP">0</span></p>
		<hr>

			
	</body>

</html>